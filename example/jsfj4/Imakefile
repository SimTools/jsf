#
# -------------------------------------------------------------------
# This is a template of Imakefile.
# Makefile is created by
#    xmkmf -a
# To use this command, the environment variable, IMAKEINCLUDE
# must be defined as collows.
#    setenv IMAKEINCLUDE "-I$JSFROOT -I$LCLIBROOT"
#
# (Author)
#    Akiya Miyamoto  27-July-2000
#
# $Id:
#
# -------------------------------------------------------------------
#


#include "conf/makejsf.tmpl"
#include "config/lclib.tmpl"

LIBNAME = libJSFJ4

SRC     = JSFJ4.$(SrcSuf) \
	JSFJ4VTXHit.$(SrcSuf) JSFJ4CDCHit.$(SrcSuf) \
	JSFJ4ITHit.$(SrcSuf) JSFJ4CALHit.$(SrcSuf) \
	JSFJ4PrimaryParticle.$(SrcSuf) JSFJ4PrimaryVertex.$(SrcSuf)

OBJS    = $(subst .$(SrcSuf),.$(ObjSuf),$(SRC)) \
	  $(G4OBJS) $(LIBNAME).$(ObjSuf)

G4SRC   = JSFJ4RunManager.$(SrcSuf) \
	JSFJ4PrimaryGeneratorAction.$(SrcSuf)

G4OBJS  = $(subst .$(SrcSuf),.$(ObjSuf),$(G4SRC)) \

HDRS    = $(subst .$(SrcSuf),.h,$(SRC))

.SUFFIXES: .cc
.cc.o :
	$(CXX) -c $(CPPFLAGS) $*.cc -o $*.o.

# CPPFLAGS =  -Wall -ansi -pedantic -pipe -fno-for-scope -DGNU_GCC
CPPFLAGS =  -Wall  -pipe  -DGNU_GCC $(CXXFLAGS)

JUPITERINCLUDE = -I$(JUPITERROOT)/sources/kern/include \
	-I$(JUPITERROOT)/sources/vtx/include \
	-I$(JUPITERROOT)/sources/it/include \
	-I$(JUPITERROOT)/sources/cdc/include \
	-I$(JUPITERROOT)/sources/cal/include \
	-I$(JUPITERROOT)/sources/ir/include \
	-I$(JUPITERROOT)/sources/bd/include

CXXFLAGS += -I./include $(JUPITERINCLUDE) \
	-I$(G4INCLUDE) \
	-DG4VIS_USE -DG4UI_USE_XM -DG4VIS_USE_OPENGLX \
	-DG4VIS_USE_OPENGLXM

#if __JSF_GNUC_VERSION__ >= 3
CXXFLAGS += -DG4USE_STD_NAMESPACE
#endif

JUPITERLIB = -L$(JUPITERROOT)/lib/$(G4SYSTEM) -lJ4bd \
	-lJ4cal -lJ4cdc -lJ4ir -lJ4it -lJ4vtx -lJ4kern

G4LIBS := -L$(G4INSTALL)/lib/$(G4SYSTEM) \
	-lG4RayTracer -lG4FR -lG4visHepRep -lG4OpenGL \
	-lG4geomBoolean -lG4emstandard 	-lG4muons -lG4hadronic_interface_ci \
	-lG4decay -lG4UIbasic -lG4VRML -lG4Tree -lG4parameterisation \
	-lG4vis_management -lG4hadronic_body_ci -lG4shortlived \
	-lG4hadronic_man_gen -lG4hadronic_stringfrag \
	-lG4hadronic_qgstring -lG4hadronic_string_common  \
	-lG4hadronic_string_common -lG4hadronic_HE_gen -lG4hadronic_kinetic \
	-lG4hadronic_stop -lG4hadronic_deex -lG4hadronic_HE \
	-lG4hadronic_util_gen -lG4modeling -lG4hadronic_proc \
	-lG4hadronic_man_gen -lG4hadronic_LE -lG4hadronic_mgt \
	-lG4hadronic_xsect -lG4hadronic_util -lG4ions -lG4mesons \
	-lG4baryons -lG4run -lG4event -lG4bosons -lG4tracking \
	-lG4emutils -lG4detector -lG4hits \
	-lG4leptons -lG4procman -lG4volumes -lG4digits -lG4geomver \
	-lG4track -lG4UIcommon -lG4partman -lG4specsolids -lG4csg \
	-lG4hepnumerics -lG4magneticfield -lG4geometrymng \
	-lG4emlowenergy \
	-lG4geombias -lG4transportation -lG4track \
	-lG4materials -lG4intercoms -lG4graphics_reps -lG4globman \
	-lGLU -lGL -lXm -lXpm -lXaw -lXmu -lXt \
	-L/usr/lib -lCLHEP

ANALLIB = -L$(LCLIBDIR) $(EXTRALDOPT) -lGENUTIL -lTAUOLA \
        -lSIMJLC -lLTKCL -lLCFULL -lTBS \
        -lHELASV204 -lFORTLIB -lCOM -lCLI \
        $(EXTRALIBS) \

ROOTLIBS     += -l$(EGPYTHIA) -lEG  $(CERNLIBS)

LDFLAGS += $(JSFLIBS) $(ANALLIB) $(JUPITERLIB) $(G4LIBS) \
	$(ROOTLIBS) $(ANALLIB) \
	-lm -ldl -l$(G77EGCS_LIBNAME)

all:: libJSFJ4.so 

libJSFJ4.so: $(OBJS) $(OBJG4)
	$(LD)  -shared -rdynamic  $(OBJS) $(OBJG4) $(LDFLAGS) -o libJSFJ4.so

install:: libJSFJ4.so
	cp -p libJSFJ4.so ../../lib


depend:: $(SRC) $(HDR)
	for i in $(SRC); do \
	rmkdepend -a -- $(DEPENDFILES) -- $$i; done

clean::
	rm -f *~ core $(LIBNAME).*

distclean:: clean
	rm jsf.root Makefile 

$(LIBNAME).$(SrcSuf): $(HDRS) LinkDef.h
	rootcint -f $@ -c -I$(JSFROOT)/include \
	-I$(JUPITERINCLUDE) \
	$(HDRS) LinkDef.h 
