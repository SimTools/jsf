#---------------------------------------------------

#include    "../conf/makejsf.tmpl"
CERNLIBS      = -L$(CERN_ROOT)/lib -ljetset74 -lpacklib

ROOTLIBS      = -L$(ROOTSYS)/lib -lNew -lBase -lCint -lClib -lCont -lFunc \
		-lEGPythia -lEG \
                -lGraf -lGraf3d -lHist -lHtml -lMatrix -lMeta -lMinuit -lNet \
                -lPostscript -lProof -lTree -lUnix -lZip \
		-Wl,-u,pytest_ \
		$(CERNLIBS)

ROOTGLIBS     = -lGpad -lGui -lGX11 -lX3d

LCLIBDIR      = $(LCLIBROOT)/lib

#ifdef hitachiArchitecture
EXTRALDOPT = -Wl,-a,default 
#endif

ANALLIB = -L$(LCLIBDIR) $(EXTRALDOPT) -lGENUTIL -lLUHADR -lTAUOLA \
        -lSIMJLC -lLTKCL -lLCFULL -lBASESV5.1 -lTBS \
        -lHELASV204 -lFORTLIB -lCOM -lCLI \
        $(EXTRALIBS)

FFLAGS = -I$(LCLIBROOT)/simjlc/src -I$(LCLIBROOT)/util/fortlib/src 

#-------------------------------------------------------------

INC           = ../include 

OBJJSF        = JSFSteer.$(ObjSuf) JSFModule.$(ObjSuf) \
		JSFDBS.$(ObjSuf) \
		libJSF.$(ObjSuf)

OBJJSFLCFULL  = JSFBases.$(ObjSuf) \
		JSFSpringParton.$(ObjSuf) JSFSpring.$(ObjSuf) \
		JSFGeneratorParticle.$(ObjSuf) JSFGenerator.$(ObjSuf) \
		JSFFULLGenerator.$(ObjSuf) JSFHadronizer.$(ObjSuf) \
		JSFLCFULL.$(ObjSuf) \
		DebugGenerator.$(ObjSuf) DebugWGenerator.$(ObjSuf) \
		PythiaGenerator.$(ObjSuf) \
		libJSFLCFULL.$(ObjSuf)

OBJJSFQUICKSIM= JSFQuickSim.$(ObjSuf) JSFLTKCLTrack.$(ObjSuf) \
		JSFSIMDST.$(ObjSuf) \
		JSFVTXHit.$(ObjSuf) JSFCALHit.$(ObjSuf) \
		JSFCDCTrack.$(ObjSuf) \
		libJSFQuickSim.$(ObjSuf) simdstutil.o

SRCJSF           = JSFSteer.$(SrcSuf) JSFModule.$(SrcSuf) 

SRCJSFLCFULL    = JSFBases.$(SrcSuf) \
		JSFSpringParton.$(SrcSuf) JSFSpring.$(SrcSuf) \
		JSFGeneratorParticle.$(SrcSuf) JSFGenerator.$(SrcSuf) \
		JSFFULLGenerator.$(SrcSuf) JSFHadronizer.$(SrcSuf) \
		JSFLCFULL.$(SrcSuf) \
		DebugGenerator.$(SrcSuf) DebugWGenerator.$(SrcSuf) \
		PythiaGenerator.$(SrcSuf)

SRCJSFQUICKSIM= JSFQuickSim.$(SrcSuf) JSFLTKCLTrack.$(SrcSuf) \
		JSFSIMDST.$(SrcSuf) \
		JSFVTXHit.$(SrcSuf) JSFCALHit.$(SrcSuf) \
		JSFCDCTrack.$(SrcSuf)


SRC = $(SRCJSF) $(SRCJSFLCFULL) $(SRCJSFQUICKSIM)

HDRJSF	      = JSFDBS.h JSFModule.h JSFSteer.h JSFLinkDef.h

HDRJSFLCFULL  = JSFBases.h \
		JSFSpringParton.h JSFSpring.h \
		JSFGeneratorParticle.h JSFGenerator.h \
		JSFFULLGenerator.h JSFHadronizer.h \
		JSFLCFULL.h \
		DebugGenerator.h DebugWGenerator.h \
		PythiaGenerator.h JSFLCFULLLinkDef.h

HDRJSFQUICKSIM= JSFVTXHit.h JSFCALHit.h \
		JSFCDCTrack.h JSFLTKCLTrack.h \
		JSFQuickSim.h JSFSIMDST.h JSFQuickSimLinkDef.h 


all::  libjsf libjsflcfull libjsfquicksim jsf

libjsf:     $(OBJJSF)
		@/bin/rm -f libJSF.a
		ar -r libJSF.a $(OBJJSF)
		@cp -p libJSF.a ../lib

libjsflcfull:     $(OBJJSFLCFULL)
		@echo "Linking libJSFLCFULL.a ..."
		@/bin/rm -f libJSFLCFULL.a
		ar -r libJSFLCFULL.a $(OBJJSFLCFULL)
		@cp -p libJSFLCFULL.a ../lib

libjsfquicksim:     $(OBJJSFQUICKSIM)
		@echo "Linking libJSFQuickSim.a ..."
		@/bin/rm -f libJSFQuickSim.a
		ar -r libJSFQuickSim.a $(OBJJSFQUICKSIM)
		@cp -p libJSFQuickSim.a ../lib

jsf: $(OBJS) jsfmain.o
	$(LD) jsfmain.o $(BLOCKDATA) \
	-L../lib -lJSF -lJSFLCFULL -lJSFQuickSim $(LDFLAGS) -o jsf
	@cp -p jsf ../bin
	@rm -f jsf
	@echo jsf was installed in ../bin/jsf

clean:: 
	@rm -f $(OBJS) core *.so *~
	@rm -f libJSF.$(SrcSuf) libJSF.h
	@rm -f libJSFLCFULL.$(SrcSuf) libJSFLCFULL.h
	@rm -f libJSFQuickSim.$(SrcSuf) libJSFQuickSim.h

depend:: 
	makedepend -I$(ROOTSYS)/include $(SRC)

distclean:: clean
	@rm -f $(OBJS) core *.so $(SONAME).$(SrcSuf) $(SONAME).h *.~ *.o
	@rm -f PYTHIA.SEED *.bak *.a
	@rm -f jsf *.root Makefile 

###

libJSF.$(SrcSuf): $(HDRJSF)
		@echo "Generating dictionary ..."
		rootcint -f libJSF.$(SrcSuf) -c $(HDRJSF)
libJSFLCFULL.$(SrcSuf): $(HDRJSFLCFULL)
		@echo "Generating dictionary ..."
		rootcint -f libJSFLCFULL.$(SrcSuf) -c $(HDRJSFLCFULL)
libJSFQuickSim.$(SrcSuf): $(HDRJSFQUICKSIM)
		@echo "Generating dictionary ..."
		rootcint -f libJSFQuickSim.$(SrcSuf) -c $(HDRJSFQUICKSIM)
#---------------------------------------------------

.SUFFIXES: .$(SrcSuf)

.$(SrcSuf).$(ObjSuf):
	$(CXX) $(CXXFLAGS) -c $<

